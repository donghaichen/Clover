{"remainingRequest":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/home/donghai/Desktop/www/clover/public/source/admin/src/views/content/Job.vue?vue&type=style&index=0&id=12cf5546&scoped=true&lang=css&","dependencies":[{"path":"/home/donghai/Desktop/www/clover/public/source/admin/src/views/content/Job.vue","mtime":1574999406000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_vue-loader@15.7.2@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.ivu-ml-8 {\n    margin-left: 8px!important;\n}\n.ivu-form {\n    margin: 20px 0!important;\n}\n/*.ivu-row{*/\n/*    margin-left: -42px!important;*/\n/*    margin-right: -12px!important;*/\n/*}*/\n.operation button {\n    margin-right: 10px;\n}\n\n",{"version":3,"sources":["Job.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Job.vue","sourceRoot":"src/views/content","sourcesContent":["<template>\r\n    <div class=\"content\">\r\n        <Card :bordered=\"false\" style=\"margin-bottom: 20px\">\r\n            <Form ref=\"formItem\" :model=\"formItem\" :label-width=\"80\">\r\n                <Row>\r\n                    <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"8\" :xl=\"8\">\r\n                        <FormItem label=\"栏目\" prop=\"category_id\">\r\n                            <Cascader :data=\"cascader\" v-model=\"formItem.category_id\" :filterable=\"true\" change-on-select></Cascader>\r\n                        </FormItem>\r\n                    </Col>\r\n                    <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"8\" :xl=\"8\">\r\n                        <FormItem label=\"标题\" prop=\"title\">\r\n                            <Input v-model=\"formItem.title\" placeholder=\"输入标题\"></Input>\r\n                        </FormItem>\r\n                    </Col>\r\n                    <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"8\" :xl=\"8\">\r\n                        <FormItem label=\"添加日期\" prop=\"date\">\r\n                            <DatePicker v-model=\"formItem.date\" show-week-numbers type=\"daterange\" split-panels placeholder=\"选择日期\" style=\"width: 100%;padding-right: 20px\"></DatePicker>\r\n                        </FormItem>\r\n                    </Col>\r\n                    <span v-if=\"drop\">\r\n                     <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"8\" :xl=\"8\">\r\n                        <FormItem label=\"推荐\" prop=\"is_recommend\">\r\n                            <Select v-model=\"formItem.is_recommend\">\r\n                                <Option value=\"1\">是</Option>\r\n                                <Option value=\"0\">否</Option>\r\n                            </Select>\r\n                        </FormItem>\r\n                      </Col>\r\n                    <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"8\" :xl=\"8\">\r\n                        <FormItem label=\"状态\" prop=\"status\">\r\n                            <Select v-model=\"formItem.status\" disabled>\r\n                                <Option value=\"publish\">已发布</Option>\r\n                                <Option value=\"draft\">草稿</Option>\r\n                                <Option value=\"pending\">等待复审</Option>\r\n                            </Select>\r\n                        </FormItem>\r\n                    </Col>\r\n                    </span>\r\n\r\n                    <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"24\" :xl=\"24\">\r\n                        <FormItem style=\"float: right;margin-right: 15px;\">\r\n                            <Button @click=\"handleSearch\" type=\"primary\" icon=\"ios-search\">查询</Button>\r\n                            <Button @click=\"handleReset('formItem')\" style=\"margin-left: 8px\">重置</Button>\r\n                            <a class=\"ivu-ml-8 drop-down\" @click=\"dropDown\" style=\"font-size: 14px;\">\r\n                                {{dropDownContent}}\r\n                                <Icon :type=\"dropDownIcon\"></Icon>\r\n                            </a>\r\n                        </FormItem>\r\n                    </Col>\r\n                    <Col :xs=\"24\" :sm=\"24\" :md=\"12\" :lg=\"24\" :xl=\"24\" style=\"margin-left: 42px;\" class=\"operation\">\r\n                        <Button @click=\"add\" type=\"primary\">新建</Button>\r\n                        <Button @click=\"delAll\" icon=\"md-trash\">批量删除</Button>\r\n                        <Button @click=\"recommendAll\" icon=\"md-trash\">批量推荐</Button>\r\n                        <Button @click=\"cancelRecommendAll\" icon=\"md-trash\">批量取消推荐</Button>\r\n                        <Dropdown @on-click=\"handleDropdown\">\r\n                            <Button>\r\n                                更多操作\r\n                                <Icon type=\"md-arrow-dropdown\" />\r\n                            </Button>\r\n                            <DropdownMenu slot=\"list\">\r\n                                <DropdownItem name=\"refresh\">刷新</DropdownItem>\r\n                                <!--                                <DropdownItem name=\"reset\">重置用户密码</DropdownItem>-->\r\n                                <!--                                <DropdownItem disable name=\"exportData\">导出所选数据</DropdownItem>-->\r\n                                <!--                                <DropdownItem name=\"exportAll\">导出全部数据</DropdownItem>-->\r\n                                <!--                                <DropdownItem name=\"importData\">导入数据(付费)</DropdownItem>-->\r\n                            </DropdownMenu>\r\n                        </Dropdown>\r\n                    </Col>\r\n                </Row>\r\n            </Form>\r\n            <Table\r\n                    :loading = \"loading\"\r\n                    :border=\"true\"\r\n                    :highlight-row=\"true\"\r\n                    :stripe=\"showStripe\"\r\n                    :show-header=\"showHeader\"\r\n                    :height=\"fixedHeader ? 250 : ''\"\r\n                    :size=\"tableSize\"\r\n                    :data=\"tableData\"\r\n                    :columns=\"tableColumns\"\r\n                    @on-selection-change=\"showSelect\"\r\n            >\r\n            </Table>\r\n            <div style=\"margin: 10px;overflow: hidden\">\r\n                <div style=\"float: right;\">\r\n                    <Page :total=\"total\" :current=\"current\" :page-size=\"pageSize\" show-total show-elevator @on-change=\"changePage\"></Page>\r\n                </div>\r\n            </div>\r\n        </Card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data () {\r\n      return {\r\n        search:{},\r\n        contentType: 'job',\r\n        cascader: [],\r\n        loading: true,\r\n        total: 0,\r\n        current: 0,\r\n        pageSize: 0,\r\n        selectCount: 0,\r\n        selectList: [],\r\n        exportData: [],\r\n        drop: false,\r\n        dropDownContent: \"展开\",\r\n        dropDownIcon: \"ios-arrow-down\",\r\n        formItem:{\r\n          category_id: [0],\r\n          title: '',\r\n          price: '',\r\n          date: '',\r\n          is_recommend: '',\r\n          status:'',\r\n        },\r\n        tableData: [],\r\n        showBorder: true,\r\n        showStripe: true,\r\n        showHeader: true,\r\n        showIndex: false,\r\n        showCheckbox: true,\r\n        fixedHeader: false,\r\n        tableSize: 'default'\r\n      }\r\n    },\r\n    created: function () {\r\n      var url = this.api.category.cascaderContent+this.contentType;\r\n      this.$axios.get(url)\r\n        .then((response) => {\r\n          if (response.data.code == 0)\r\n          {\r\n            this.cascader = response.data.data\r\n          }else{\r\n            this.$Message.error('数据获取失败，请检查');\r\n          }\r\n        })\r\n      this.getData()\r\n    },\r\n    methods: {\r\n      add() {\r\n        this.gotoPage(this.contentType + 'View',{\r\n          id: 0\r\n        })\r\n      },\r\n      handleSearch() {\r\n        let params = {\r\n          category_id: this.formItem.category_id,\r\n          title: this.formItem.title,\r\n          date: this.formItem.date,\r\n          is_recommend: this.formItem.is_recommend,\r\n          status: this.formItem.status,\r\n        }\r\n        this.search = params\r\n\r\n        this.getData(0, params)\r\n        window.console.log('search')\r\n      },\r\n      handleReset (name) {\r\n        this.$refs[name].resetFields();\r\n        this.getData();\r\n      },\r\n      gotoPage: function(name, params = {}){\r\n        this.$router.push({  //核心语句\r\n          name:name,   //跳转的路径\r\n          query:params,   //跳转的参数\r\n        })\r\n      },\r\n      getData(page = 0, params = {}) {\r\n        this.loading = true;\r\n        page = page > 0 ? page : 0;\r\n\r\n        this.$axios.get(this.api.content.list + this.contentType + '?page=' + page, {params:params})\r\n          .then((response) => {\r\n            this.loading = false;\r\n            this.tableData = response.data.data.data\r\n            this.current = response.data.data.current_page\r\n            this.total = response.data.data.total\r\n            this.pageSize = response.data.data.per_page\r\n            return this.tableData\r\n          })\r\n      },\r\n      dropDown() {\r\n        if (this.drop) {\r\n          this.dropDownContent = \"展开\";\r\n          this.dropDownIcon = \"ios-arrow-down\";\r\n        } else {\r\n          this.dropDownContent = \"收起\";\r\n          this.dropDownIcon = \"ios-arrow-up\";\r\n        }\r\n        this.drop = !this.drop;\r\n      },\r\n      show (index) {\r\n        window.console.log(index)\r\n      },\r\n      remove (params) {\r\n        this.delete(params.row.id)\r\n      },\r\n      changePage (index) {\r\n        this.tableData = this.getData(index, this.search);\r\n      },\r\n      delete(id){\r\n        this.$axios.post(this.api.content.contentDelete, {\r\n          id: id,\r\n          type: this.contentType\r\n        })\r\n          .then((response) => {\r\n            this.loading = false;\r\n            if (response.data.code == 0)\r\n            {\r\n              this.$Modal.remove();\r\n              this.$Message.success(\"删除成功\");\r\n            }else{\r\n              this.$Message.error(response.data.msg);\r\n            }\r\n            this.getData()\r\n          })\r\n      },\r\n      delAll() {\r\n        if (this.selectCount <= 0) {\r\n          this.$Message.warning(\"您还未选择要删除的数据\");\r\n          return;\r\n        }\r\n        this.$Modal.confirm({\r\n          title: \"确认删除\",\r\n          content: \"您确认要删除所选的 \" + this.selectCount + \" 条数据?\",\r\n          loading: true,\r\n          onOk: () => {\r\n            let ids = \"\";\r\n            this.selectList.forEach(function(e) {\r\n              ids += e.id + \",\";\r\n            });\r\n            ids = ids.substring(0, ids.length - 1);\r\n            this.delete(ids)\r\n          }\r\n        });\r\n      },\r\n      recommend(id, isRecommend = 0){\r\n        this.$axios.post(this.api.content.contentRecommend, {\r\n          id: id,\r\n          type: this.contentType,\r\n          recommend: isRecommend\r\n        })\r\n          .then((response) => {\r\n            this.loading = false;\r\n            if (response.data.code == 0)\r\n            {\r\n              this.$Modal.remove();\r\n              let msg = isRecommend === 1 ? \"推荐成功\" : '取消推荐成功'\r\n              this.$Message.success(msg);\r\n            }else{\r\n              this.$Modal.remove();\r\n              this.$Message.error(response.data.msg);\r\n            }\r\n            this.getData()\r\n          })\r\n      },\r\n      recommendAll() {\r\n        if (this.selectCount <= 0) {\r\n          this.$Message.warning(\"您还未选择要操作的数据\");\r\n          return;\r\n        }\r\n        this.$Modal.confirm({\r\n          title: \"确认推荐\",\r\n          content: \"您确认要推荐所选的 \" + this.selectCount + \" 条数据?\",\r\n          loading: true,\r\n          onOk: () => {\r\n            let ids = \"\";\r\n            this.selectList.forEach(function(e) {\r\n              ids += e.id + \",\";\r\n            });\r\n            ids = ids.substring(0, ids.length - 1);\r\n            this.recommend(ids, 1)\r\n          }\r\n        });\r\n      },\r\n      cancelRecommendAll() {\r\n        if (this.selectCount <= 0) {\r\n          this.$Message.warning(\"您还未选择要操作的数据\");\r\n          return;\r\n        }\r\n        this.$Modal.confirm({\r\n          title: \"取消推荐\",\r\n          content: \"您确认要取消推荐所选的 \" + this.selectCount + \" 条数据?\",\r\n          loading: true,\r\n          onOk: () => {\r\n            let ids = \"\";\r\n            this.selectList.forEach(function(e) {\r\n              ids += e.id + \",\";\r\n            });\r\n            ids = ids.substring(0, ids.length - 1);\r\n            this.recommend(ids, 0)\r\n          }\r\n        });\r\n      },\r\n      showSelect(e) {\r\n        // window.console.log(e)\r\n        this.exportData = e;\r\n        this.selectList = e;\r\n        this.selectCount = e.length;\r\n      },\r\n      handleDropdown(name) {\r\n        switch (name) {\r\n          case 'refresh':\r\n            this.getData()\r\n            break\r\n          default:\r\n        }\r\n      },\r\n    },\r\n    computed: {\r\n      tableColumns () {\r\n        let columns = [];\r\n        if (this.showCheckbox) {\r\n          columns.push({\r\n            type: 'selection',\r\n            width: 60,\r\n            align: 'center'\r\n          })\r\n        }\r\n        columns.push({\r\n          title: 'ID',\r\n          width: 80,\r\n          key: 'id',\r\n        });\r\n        columns.push({\r\n          title: '所属栏目',\r\n          key: 'category_name',\r\n          sortable: true,\r\n          width: 120,\r\n          tooltip: true\r\n        });\r\n        columns.push({\r\n          title: '标题',\r\n          key: 'title',\r\n          width: 300,\r\n          tooltip: true\r\n        });\r\n        columns.push({\r\n          title: '状态',\r\n          key: 'status_cn',\r\n          align: 'center',\r\n          width: 150,\r\n          render: (h, params) => {\r\n            const row = params.row;\r\n            // $status_cn = ['draft' => '草稿', 'pending' => '等待复审', 'publish' => '已发布'];\r\n            const color = row.status === 'publish' ? 'primary' : row.status === 'draft' ? 'success' : 'error';\r\n            const text = row.status_cn;\r\n            return h('Tag', {\r\n              props: {\r\n                type: 'dot',\r\n                color: color\r\n              }\r\n            }, text);\r\n          }\r\n        });\r\n        columns.push({\r\n          title: '推荐',\r\n          key: 'is_recommend',\r\n          align: 'center',\r\n          width: 70,\r\n          render: (h, params) => {\r\n            const row = params.row;\r\n            const color = row.is_recommend === 1 ? 'success' : 'default';\r\n            const text = row.is_recommend === 1 ? '是' : '否';\r\n            const recommend = row.is_recommend === 1 ? 0 : 1;\r\n            return h('Button', {\r\n              props: {\r\n                type: color,\r\n                size: 'small'\r\n              },\r\n              on: {\r\n                click: () => {\r\n                  this.recommend(params.row.id, recommend)\r\n                }\r\n              }\r\n            }, text);\r\n          }\r\n        });\r\n        // columns.push({\r\n        //   title: '特价',\r\n        //   key: 'is_offer',\r\n        //   align: 'center',\r\n        //   width: 70,\r\n        //   render: (h, params) => {\r\n        //     const row = params.row;\r\n        //     const color = row.is_offer === 1 ? 'success' : 'default';\r\n        //     const text = row.is_offer === 1 ? '是' : '否';\r\n        //     return h('Tag', {\r\n        //       props: {\r\n        //         color: color\r\n        //       }\r\n        //     }, text);\r\n        //   }\r\n        // });\r\n        columns.push({\r\n          title: '点击量',\r\n          key: 'click_count',\r\n          align: 'center',\r\n          sortable: true,\r\n          width: 100,\r\n        });\r\n        columns.push({\r\n          title: '缩略图',\r\n          key: 'image',\r\n          render: (h, params) => {\r\n            let image = params.row.image\r\n            if(image.length > 0 && image.substr(0,4).toLowerCase() != \"http\")\r\n            {\r\n              image = this.api.static.baseUrl + image;\r\n            }\r\n            return h('Avatar', {\r\n              props: {\r\n                icon: 'ios-image',\r\n                src: image,\r\n                shape: 'square',\r\n                // size: 'small',\r\n              }\r\n            });\r\n          }\r\n        });\r\n        columns.push({\r\n          title: '添加时间',\r\n          key: 'created_at',\r\n          sortable: true,\r\n          tooltip: true\r\n        });\r\n        columns.push({\r\n          title: '更新时间',\r\n          key: 'updated_at',\r\n          sortable: true,\r\n          tooltip: true\r\n        });\r\n        // columns.push({\r\n        //   title: '发布时间',\r\n        //   key: 'published_at',\r\n        //   sortable: true,\r\n        // });\r\n        columns.push({\r\n          title: '操作',\r\n          key: 'action',\r\n          width: 150,\r\n          align: 'center',\r\n          render: (h, params) => {\r\n            return h('div', [\r\n              h('Button', {\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.gotoPage(this.contentType + 'View',{\r\n                      id: params.row.id\r\n                    })\r\n                  }\r\n                }\r\n              }, '详情'),\r\n              h('Button', {\r\n                props: {\r\n                  type: 'error',\r\n                  size: 'small'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.remove(params)\r\n                  }\r\n                }\r\n              }, '删除')\r\n            ]);\r\n          }\r\n        });\r\n        return columns;\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n    .ivu-ml-8 {\r\n        margin-left: 8px!important;\r\n    }\r\n    .ivu-form {\r\n        margin: 20px 0!important;\r\n    }\r\n    /*.ivu-row{*/\r\n    /*    margin-left: -42px!important;*/\r\n    /*    margin-right: -12px!important;*/\r\n    /*}*/\r\n    .operation button {\r\n        margin-right: 10px;\r\n    }\r\n\r\n</style>"]}]}