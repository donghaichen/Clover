{"remainingRequest":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/home/donghai/Desktop/www/clover/public/source/admin/src/views/setting/Setting.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/donghai/Desktop/www/clover/public/source/admin/src/views/setting/Setting.vue","mtime":1574999408000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_vue-loader@15.7.2@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/donghai/Desktop/www/clover/public/source/admin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.ivu-form\n{\n    padding: 20px;\n}\n.ivu-form .ivu-form-item-label\n{\n    text-align: left;\n    width: 120px!important;\n}\n.ivu-form .ivu-form-item-content{\n    margin-left: 130px!important;\n}\n",{"version":3,"sources":["Setting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Setting.vue","sourceRoot":"src/views/setting","sourcesContent":["<template>\r\n    <div class=\"content\">\r\n            <Card :bordered=\"false\">\r\n                <p slot=\"title\">系统设置</p>\r\n                <Tabs value=\"name1\">\r\n                    <TabPane label=\"基本设置\" name=\"name1\">\r\n                        <Form ref=\"formItem\" :model=\"formItem\" :rules=\"ruleValidate\" :label-width=\"80\">\r\n                            <FormItem label=\"站点名称\" >\r\n                                <Input v-model=\"formItem.title\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"站点域名\">\r\n                                <Input v-model=\"formItem.url\" placeholder=\"\"><span slot=\"prepend\">http://</span></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"站点标题\">\r\n                                <Input v-model=\"formItem.seo_title\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"站点关键词\">\r\n                                <Input v-model=\"formItem.keywords\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"首页简介\">\r\n                                <Input v-model=\"formItem.home_title\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"站点描述\">\r\n                                <Input v-model=\"formItem.description\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"站点 LOGO\">\r\n                                <Input v-model=\"formItem.logo\" disabled placeholder=\"\" :value=\"uploadList[0].url\"></Input>\r\n                                <p class=\"desc\">支持上传的文件格式为 jpg·jpeg·png·gif 且文件大小不超过 {{file_size}} M</p>\r\n                                <Upload\r\n                                        ref=\"upload\"\r\n                                        :show-upload-list=\"false\"\r\n                                        :on-success=\"handleSuccess\"\r\n                                        :on-error=\"handleError\"\r\n                                        :max-size=\"file_size * 1024\"\r\n                                        :on-format-error=\"handleFormatError\"\r\n                                        :on-exceeded-size=\"handleMaxSize\"\r\n                                        :format=\"['jpg','jpeg','png', 'gif']\"\r\n                                        :action=\"uploadUrl\">\r\n                                    <Button icon=\"ios-cloud-upload-outline\">上传</Button>\r\n                                </Upload>\r\n                                <Button style=\"margin-left: 100px;margin-top: -68px;\" @click=\"viewPic(formItem.logo)\">查看图片</Button>\r\n                            </FormItem>\r\n                            <FormItem label=\"微信公众号二维码\">\r\n                                <Input v-model=\"formItem.qrcode\" disabled placeholder=\"\" :value=\"uploadList[0].url\"></Input>\r\n                                <p class=\"desc\">支持上传的文件格式为 jpg·jpeg·png·gif 且文件大小不超过 {{file_size}} M</p>\r\n                                <Upload\r\n                                        ref=\"upload\"\r\n                                        :show-upload-list=\"false\"\r\n                                        :on-success=\"qrCodeHandleSuccess\"\r\n                                        :on-error=\"handleError\"\r\n                                        :max-size=\"file_size * 1024\"\r\n                                        :on-format-error=\"handleFormatError\"\r\n                                        :on-exceeded-size=\"handleMaxSize\"\r\n                                        :format=\"['jpg','jpeg','png', 'gif']\"\r\n                                        :action=\"uploadUrl\">\r\n                                    <Button icon=\"ios-cloud-upload-outline\">上传</Button>\r\n                                </Upload>\r\n                                <Button style=\"margin-left: 100px;margin-top: -68px;\" @click=\"viewPic(formItem.qrcode)\">查看图片</Button>\r\n                            </FormItem>\r\n                            <FormItem label=\"公司名称\">\r\n                                <Input v-model=\"formItem.company_name\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"公司地址\">\r\n                                <Input v-model=\"formItem.company_address\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"客服邮箱\">\r\n                                <Input v-model=\"formItem.contact_email\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"客服 QQ\">\r\n                                <Input v-model=\"formItem.qq\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"联系人\">\r\n                                <Input v-model=\"formItem.contact_name\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"客服电话\">\r\n                                <Input v-model=\"formItem.contact_tel\" placeholder=\"\"></Input>\r\n                                <p>客服电话在网站前台展示，请正确填写</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"ICP 备案号\">\r\n                                <Input v-model=\"formItem.icp\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"统计代码\">\r\n                                <Input v-model=\"formItem.code\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem>\r\n                                <Button type=\"primary\" @click=\"handleSubmit('formItem')\">保存</Button>\r\n                            </FormItem>\r\n                        </Form>\r\n                    </TabPane>\r\n                    <TabPane label=\"安全设置\" name=\"name3\">\r\n                        <Form ref=\"formItem\" :model=\"formItem\" :rules=\"ruleValidate\" :label-width=\"80\">\r\n                            <FormItem label=\"站点状态\">\r\n                                <i-switch v-model=\"formItem.status\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                                <p>（站点维护，突发紧急状况），请关闭此选项。正常运营期间严禁关闭网站</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"开放注册\">\r\n                                <i-switch v-model=\"formItem.isRegister\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                                <p>如果关闭注册，将不能注册新会员，已注册会员可以登录和其他操作不受影响。</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"最大上传限制\">\r\n                                <Input v-model=\"formItem.file_size\" placeholder=\"\"></Input>\r\n                                <p>（单位 MB 1G=1024MB），上传最大限制受服务器设置影响，如您不清楚，可以联系您的服务器供应商</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"上传格式白名单\">\r\n                                <Input v-model=\"formItem.file_ext\" placeholder=\"\"></Input>\r\n                                <p>因系统安全需要，禁止上传(.php, .js, .sql)类型的文件，后缀之间用英文逗号隔开，不在格式白名单的文件将被禁止上传</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"URL 重写\">\r\n                                <i-switch v-model=\"formItem.rewrite\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                                <p>需要 Rewrite 支持，启用前请重命名根目录 .htaccess.txt 文件为 .htaccess</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"登录验证\">\r\n                                <i-switch v-model=\"formItem.verify_code\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                                <p>设置（会员）登录验证，后台登录验证为永久开启状态，不提供关闭功能</p>\r\n                            </FormItem>\r\n                            <FormItem>\r\n                                <Button type=\"primary\" @click=\"handleSubmit('formItem')\">保存</Button>\r\n                            </FormItem>\r\n                        </Form>\r\n                    </TabPane>\r\n                    <TabPane label=\"显示设置\" name=\"name2\">\r\n                        <Form ref=\"formItem\" :model=\"formItem\" :rules=\"ruleValidate\" :label-width=\"80\">\r\n                            <FormItem label=\"站点语言\">\r\n                                <Select v-model=\"formItem.lang\">\r\n                                    <Option value=\"zh_cn\">中文简体</Option>\r\n                                    <Option value=\"en_us\">英文</Option>\r\n                                    <Option value=\"zh_tw\">中文繁体</Option>\r\n                                </Select>\r\n                            </FormItem>\r\n                            <FormItem label=\"图片水印\">\r\n                                <i-switch v-model=\"formItem.watermark\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                            </FormItem>\r\n                            <FormItem label=\"水印 LOGO\">\r\n                                <Input v-model=\"formItem.watermarkLogo\" disabled placeholder=\"\"></Input>\r\n                                <p class=\"desc\">支持上传的文件格式为 jpg·jpeg·png·gif 且文件大小不超过 {{file_size}} M</p>\r\n                                <Upload\r\n                                        ref=\"upload\"\r\n                                        :show-upload-list=\"false\"\r\n                                        :on-success=\"watermarkHandleSuccess\"\r\n                                        :on-error=\"handleError\"\r\n                                        :max-size=\"file_size * 1024\"\r\n                                        :on-format-error=\"handleFormatError\"\r\n                                        :on-exceeded-size=\"handleMaxSize\"\r\n                                        :format=\"['jpg','jpeg','png', 'gif']\"\r\n                                        :action=\"uploadUrl\">\r\n                                    <Button icon=\"ios-cloud-upload-outline\">上传</Button>\r\n                                </Upload>\r\n                                <Button style=\"margin-left: 100px;margin-top: -68px;\" @click=\"viewPic(formItem.watermarkLogo)\">查看图片</Button>\r\n                            </FormItem>\r\n                            <FormItem label=\"水印位置\">\r\n                                <RadioGroup v-model=\"formItem.watermark_location\">\r\n                                    <Radio label=\"top\">上</Radio>\r\n                                    <Radio label=\"bottom\">下</Radio>\r\n                                    <Radio label=\"left\">左</Radio>\r\n                                    <Radio label=\"right\">右</Radio>\r\n                                    <Radio label=\"middle\">中</Radio>\r\n                                    <Radio label=\"random\">随机</Radio>\r\n                                </RadioGroup>\r\n                            </FormItem>\r\n                            <FormItem label=\"产品列表数量\">\r\n                                <Input v-model=\"formItem.product_list_num\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"产品属性\">\r\n                                <Input v-model=\"formItem.product_attribute\" placeholder=\"\"></Input>\r\n                                <p>如\"颜色,尺寸,型号\"中间以英文逗号隔开</p>\r\n                            </FormItem>\r\n                            <FormItem label=\"新闻列表数量\">\r\n                                <Input v-model=\"formItem.news_list_num\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem>\r\n                                <Button type=\"primary\" @click=\"handleSubmit('formItem')\">保存</Button>\r\n                            </FormItem>\r\n                        </Form>\r\n                    </TabPane>\r\n                    <TabPane label=\"邮件服务器\" name=\"name4\">\r\n                        <Form ref=\"formItem\" :model=\"formItem\" :rules=\"ruleValidate\" :label-width=\"80\">\r\n                            <FormItem label=\"使用SMTP\">\r\n                                <i-switch v-model=\"formItem.smtp\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                            </FormItem>\r\n                            <FormItem label=\"服务器\">\r\n                                <Input v-model=\"formItem.smtp_server\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"端口\">\r\n                                <Input v-model=\"formItem.smtp_port\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"开启SSL\">\r\n                                <i-switch v-model=\"formItem.smtp_ssl\" size=\"large\">\r\n                                    <span slot=\"true\">开启</span>\r\n                                    <span slot=\"false\">关闭</span>\r\n                                </i-switch>\r\n                            </FormItem>\r\n                            <FormItem label=\"邮箱\">\r\n                                <Input v-model=\"formItem.smtp_mail\" placeholder=\"\"></Input>\r\n                            </FormItem>\r\n                            <FormItem label=\"密码\"  prop=\"smtp_passwd\">\r\n                                <Input type=\"password\" v-model=\"formItem.smtp_passwd\" placeholder=\"\"></Input>\r\n                                <p>部分邮箱是授权码，如果您不清楚，请联系您的邮箱供应商</p>\r\n                            </FormItem>\r\n                            <FormItem>\r\n                                <Button type=\"primary\" @click=\"handleSubmit('formItem')\">保存</Button>                           \r\n                            </FormItem>\r\n                        </Form>\r\n                    </TabPane>\r\n                </Tabs>\r\n            </Card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data () {\r\n      return {\r\n        file_size: JSON.parse(localStorage.getItem('config')).file_size,\r\n        uploadUrl: this.api.common.upload,\r\n        formItem: {\r\n          title: '',\r\n          url: '',\r\n          seo_title: '',\r\n          keywords: '',\r\n          description: '',\r\n          home_title: '',\r\n          logo: '',\r\n          qrcode: '',\r\n          company_name: '',\r\n          company_address: '',\r\n          contact_tel: '',\r\n          contact_email: '',\r\n          qq: '',\r\n          contact_name:'',\r\n          icp: '',\r\n          code: '',\r\n          status: true,\r\n          isRegister:false,\r\n          file_size:'',\r\n          file_ext:'',\r\n          rewrite: true,\r\n          verify_code: false,\r\n          lang: 'zh_cn',\r\n          watermark: true,\r\n          watermarkLogo: '',\r\n          watermark_location: 'bottom',\r\n          product_list_num: 10,\r\n          product_attribute: '',\r\n          news_list_num: 10,\r\n          smtp: true,\r\n          smtp_server: '',\r\n          smtp_port: '',\r\n          smtp_ssl: true,\r\n          smtp_mail: '',\r\n          smtp_passwd: '',\r\n        },\r\n        ruleValidate: {\r\n\r\n        },\r\n        uploadList: [\r\n          {\r\n            url: ''\r\n          }\r\n        ],\r\n      }\r\n    },\r\n    created() {\r\n      this.uploadUrl = this.uploadUrl + '?module=setting'\r\n      this.getData()\r\n    },\r\n    mounted () {\r\n    },\r\n    methods: {\r\n      getData()\r\n      {\r\n        var url = this.api.common.setting;\r\n        this.$axios.get(url)\r\n          .then((response) => {\r\n            if (response.data.code == 0)\r\n            {\r\n              this.formItem = response.data.data\r\n            }else{\r\n              this.$Message.error('数据获取失败，请检查');\r\n            }\r\n          })\r\n      },\r\n      viewPic (src) {\r\n        if(src.length <= 0)\r\n        {\r\n          this.$Message.error('尚未上传图片，无法查看')\r\n          return false\r\n        }\r\n        const title = '查看图片';\r\n        const content = '<img style=\"width: 88%\" src=\"' +this.api.static.baseUrl + src +'\">';\r\n        this.$Modal.info({\r\n          title: title,\r\n          content: content\r\n        });\r\n      },\r\n      handleSuccess (response) {\r\n        this.formItem.logo = response.data.url\r\n        this.$Message.success('上传成功')\r\n      },\r\n      qrCodeHandleSuccess (response) {\r\n        this.formItem.qrcode = response.data.url\r\n        this.$Message.success('上传成功')\r\n      },\r\n      watermarkHandleSuccess (response) {\r\n        this.formItem.watermarkLogo = response.data.url\r\n        this.$Message.success('上传成功')\r\n      },\r\n      handleError (event) {\r\n        window.console.log(event)\r\n        this.$Message.error('上传错误，请重新上传')\r\n\r\n      },\r\n      handleFormatError (file) {\r\n        this.$Notice.warning({\r\n          title: '文件格式错误',\r\n          desc: '文件： ' + file.name + ' 格式错误, 请上传允许的文件.'\r\n        });\r\n      },\r\n      handleMaxSize (file) {\r\n        this.$Notice.warning({\r\n          title: '文件大小超过限制',\r\n          desc: '文件：  ' + file.name + ' 不超过' +  this.file_size + 'M'\r\n        });\r\n      },\r\n      query(data) {\r\n        var url = this.api.user.view11;\r\n        this.$axios.post(url, data)\r\n          .then((response) => {\r\n            if (response.data.code == 0)\r\n            {\r\n              this.$Message.success('操作成功');\r\n            }else{\r\n              this.$Message.error(response.data.msg);\r\n            }\r\n          })\r\n      },\r\n      handleSubmit (name) {\r\n        this.$refs[name].validate((valid) => {\r\n          if (valid) {\r\n            var url = this.api.common.setting;\r\n            this.$axios.post(url, this.formItem)\r\n              .then((response) => {\r\n                if (response.data.code == 0)\r\n                {\r\n                  this.$Message.success('操作成功');\r\n                  // 更新本地配置\r\n                  this.$axios.get(this.api.common.localConfig)\r\n                    .then((response) => {\r\n                      if (response.data.code == 0)\r\n                      {\r\n                        localStorage.setItem('config', JSON.stringify(response.data.data))\r\n                      }else{\r\n                        // 更新本地配置不成功\r\n                        this.$Message.error('数据同步到本地异常，请退出登录重新登录');\r\n                      }\r\n                    })\r\n                }else{\r\n                  this.$Message.error(response.data.msg);\r\n                }\r\n              })\r\n          } else {\r\n            this.$Message.error('请正确输入表单内容');\r\n          }\r\n        })\r\n      },\r\n      handleReset (name) {\r\n        this.$refs[name].resetFields();\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n    .ivu-form\r\n    {\r\n        padding: 20px;\r\n    }\r\n    .ivu-form .ivu-form-item-label\r\n    {\r\n        text-align: left;\r\n        width: 120px!important;\r\n    }\r\n    .ivu-form .ivu-form-item-content{\r\n        margin-left: 130px!important;\r\n    }\r\n</style>"]}]}